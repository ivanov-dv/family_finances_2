{% extends 'base.html' %}
{% load humanize %}

{% block core_settings_info %}
    <nav class="navbar bg-body-tertiary">
      <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">
          üìÖ <a class="navbar-brand text-white" href="{% url 'transactions:change_period' %}?next={{ next|urlencode }}">{{ current_month }}.{{ current_year }}</a>
        </span>
        <span class="navbar-brand mb-0 h1">üìì {{ current_space.name }} ({{ current_space.user.username }})</span>
      </div>
    </nav>
{% endblock %}

{% block content %}
    <div class="main-content" id="main-content">
        <div class="container mt-4">
            <div class="row justify-content-center">
                <h5 class="text-center">–û–ø–µ—Ä–∞—Ü–∏–∏</h5>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–¢–∏–ø</th>
                                <th>–°—Ç–∞—Ç—å—è</th>
                                <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                <th>–ê–≤—Ç–æ—Ä</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for transaction in transactions %}
                                <tr>
                                    <td>{{ transaction.created_at|date:"d.m.Y" }}</td>
                                    {% if transaction.type_transaction == 'income' %}
                                        <td>–î–æ—Ö–æ–¥</td>
                                    {% else %}
                                        <td>–†–∞—Å—Ö–æ–¥</td>
                                    {% endif %}
                                    <td>{{ transaction.group_name }}</td>
                                    <td>{{ transaction.value_transaction|intcomma }}</td>
                                    <td>{{ transaction.description }}</td>
                                    <td>{{ transaction.author.username }}</td>
                                </tr>
                            {% empty %}
                                <tr><td colspan="6" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="container mt-5">
        <a href="{% url 'export:excel' %}">
            <button class="btn btn-light me-2"
                    data-bs-toggle="popover"
                    data-bs-placement="top"
                    data-bs-trigger="focus"
                    data-bs-content="–ö–Ω–æ–ø–∫–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ Telegram Webapp.
                    –î–ª—è Telegram –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é –±–æ—Ç–∞ - '–ü—Ä–æ—Å–º–æ—Ç—Ä'.">
                –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
            </button>
        </a>
    </div>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö popover –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        document.addEventListener('DOMContentLoaded', function () {
            const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]');
            const popoverList = [...popoverTriggerList].map(popoverTriggerEl => new bootstrap.Popover(popoverTriggerEl));
        });
    </script>
{% endblock %}
